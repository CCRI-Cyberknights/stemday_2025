# 🌟 `stemday_2025` Project README (Admin-Only)

Welcome to the **CCRI CyberKnights STEM Day VM Project!** 🎉  
This repository powers a custom **Parrot Linux Capture The Flag (CTF)** experience designed for high school students.

👥 **This repository is for CCRI CyberKnights club members only.**  
It contains all source files, admin tools, and scripts used to **build and maintain** the student-facing version of the CTF.

📝 **If you’re preparing the VM for students:**  
The *student version* includes only the **essential challenge files and launcher**, without admin tools or developer resources. That bundle is auto-generated by our tools and placed in the VM’s `Desktop` folder.

To download Parrot Linux for testing: [https://www.parrotsec.org/download/](https://www.parrotsec.org/download/)  
The student VM uses the **Home Edition**, but you can test with the full **Security Edition** as well—it’s essentially a more advanced Kali Linux.

---

## 🌀 Quick Setup (One-Liner)

To set up the admin environment and clone this repository, run:

```bash
curl -fsSL https://raw.githubusercontent.com/CCRI-Cyberknights/stemday_2025/main/setup_contributor.py | python3 -
```

This will:  
✅ Install Git and all required tools  
✅ Configure Git credentials (if not already set)  
✅ Clone this repository into your current directory

⚠️ **Note:** These scripts are intended for Parrot OS or other Debian-based systems (like Ubuntu).

---

## 🗂️ Project Structure (Admin Repo)

```
Desktop/
├── stemday_2025/
│   ├── challenges/                 # Guided-mode challenges (with hints/scripts)
│   ├── challenges_solo/            # Solo-mode challenges (minimal hints, self-guided)
│   ├── web_version/                # Student-facing web portal (auto-generated)
│   ├── web_version_admin/          # Admin-only tools and templates
│   ├── Launch CCRI CTF Hub.desktop # Student launcher shortcut
│   ├── generate_all_flags.py       # 🔐 Master script to generate real/fake flags
│   ├── validate_all_flags.py       # ✅ Master script to validate student submissions
│   ├── copy_ccri_ctf.py            # 📦 Copies student-ready files to VM desktop
│   ├── README.md                   # This file
│   └── CONTRIBUTING.md             # Club contribution guidelines
```

---

## 🧭 Guided vs Solo Modes

This year’s CTF supports two parallel challenge tracks:

- **Guided Mode** (`challenges/`):  
  Each challenge has an interactive helper script to walk students through the solution path.

- **Solo Mode** (`challenges_solo/`):  
  The same technical objectives, but with only minimal hints, encouraging more independent exploration.

Students can pick either mode from the **web portal** in `web_version/`.

---

## 🚩 Flag Generation and Validation

The CTF uses a **centralized and consistent flag system** to ensure students cannot shortcut or guess solutions, while allowing automated validation for instructors.

### 🔨 Flag Generation

Use the `generate_all_flags.py` script to:

- Generate unique **real flags** for each challenge
- Plant multiple **fake flags** to deter guesswork
- Populate `challenges/` and `challenges_solo/` with pre-obfuscated challenge content
- Write structured metadata to:
  - `validation_unlocks.json` (for guided mode)
  - `validation_unlocks_solo.json` (for solo mode)
  - `challenges.json` and `challenges_solo.json` (used by the webserver for runtime validation)

---

### ✅ Flag Validation: How It Works

There are **two layers of flag validation** in this system:

#### 1. `validate_all_flags.py` (Admin-side validator)
- This script simulates the student's solving process to ensure flags were embedded correctly and all challenge logic works as intended.
- It **relies on extra metadata and logic embedded inside the helper scripts** in `challenges/`, which mimic the expected steps a student would perform.
- There are **no** helper scripts in challenges_solo so it relies on the logic within `challenges/` for validation

  > 💡 **Note:** These embedded helper scripts include hidden logic and validation steps that are **invisible to the student** when run during normal gameplay.

#### 2. Student Web Portal (Live validation during gameplay)
- When a student submits a flag on a challenge page, the local Flask webserver:
  - Checks the flag against `challenges.json` (for guided) or `challenges_solo.json` (for solo)
  - Says either incorrect/correct flag on button press and back on the index.html replaces the challenge button with "challlenge completed" and a green checkmark.
- These JSON files are auto-written by `generate_all_flags.py`, reflecting the current real flag for each challenge.

  > ⚠️ Be sure to **start the Flask server (`server.py`) before validating**, especially for **Challenge #17 (Nmap Scan)**, which checks for open simulated ports during validation.

---

## 🚀 Preparing the Student VM

To build and install the CTF experience on the student VM:

1. From your admin system, run:

   ```bash
   ./generate_all_flags.py     # Generate flags and prepare folders
   ./start_web_hub.py          # Starts the webserver
   ./validate_all_flags.py     # Makes sure what was generated can actually be used to unlock/decrypt/unzip the various files necessary to retrieve the flag and that the flag is correct
   ./web_version_admin/create_website/build_web_version.py #Creates the obfusicated .jsons and .pycs for the student experience
   ./copy_ccri_ctf.py          # Copy only the student-relevant files
   ```

2. On the student VM desktop:

   - Right-click `Launch CCRI CTF Hub.desktop` → **Properties → Permissions**
   - ✅ Enable *“Allow this file to run as a program”*

This shortcut launches the student-facing challenge hub in a browser.

---

## 🙌 Club Member Guidelines

✅ Keep admin-only files out of student view  
✅ Test both guided and solo modes before finalizing  
✅ Use relative paths in all scripts  
✅ Don’t commit `.pyc` files or output bundles, utilize the .gitignore

---

## 🎓 Thanks for helping build CCRI CyberKnights STEM Day CTF!

For contribution details, see [CONTRIBUTING.md](CONTRIBUTING.md).
